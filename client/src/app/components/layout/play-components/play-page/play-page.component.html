<div class="root">
    <div class="col-analysis">
        <app-section class="analysis-board">
            <p>Analysis Board</p>
            <app-interactive-tetris-board
                [grid]="getLastPosition()?.grid"
                [level]="18"
                [currentPiece]="getBestMove()?.thisPiece"
                [nextPiece]="getBestMove()?.nextPiece"
            />
        </app-section>
        <app-section class="best-move-info">
            <h2 class="best-move">(+2.3)  S-890  L-12</h2>
            <p class="best-move-explanation">An s-flat minimizes burns while keeping a stable board</p>
        </app-section>

    </div>
    <app-eval-bar class="col-eval-bar"
    [playerEval]="getMoveRating()?.playerNB"
    [bestEval]="getMoveRating()?.bestNB" 
    [rating]="getMoveRating()?.rating"/>
    <app-section class="col-capture">
        <h1 class="padded">Live Capture Mode â€¢ <span [ngStyle]="{'color': getStatusColor()}">{{getStatusString()}}</span></h1>

        <canvas #canvasElement
        [width]="videoCaptureService.OCR_WIDTH" [height]="videoCaptureService.OCR_HEIGHT"
        [style.width.px]="videoCaptureService.DISPLAY_WIDTH" [style.height.px]="videoCaptureService.DISPLAY_HEIGHT"
        [style.display]="isInGame() ? 'none' : 'block'"></canvas>

        <app-tetris-panel *ngIf="isInGame()">
            <app-interactive-tetris-board
                    [grid]="extractedState.getGrid()"
                    [level]="extractedState.getStatus().level"
                    [paused]="extractedState.getPaused()"
                />
            <app-tetris-panel-item>
                <h2>Score</h2>
                <h1>{{getScoreString()}}</h1>
            </app-tetris-panel-item>
            <div class="level-lines">
                <app-tetris-panel-item>
                    <h2>Lines</h2>
                    <h1>{{getLinesString()}}</h1>
                </app-tetris-panel-item>
                <app-tetris-panel-item>
                    <h2>Level</h2>
                    <h1>{{getLevelString()}}</h1>
                </app-tetris-panel-item>
            </div>
            <app-tetris-panel-item>
                <app-next-box [showBackground]="false" [level]="extractedState.getStatus().level" [type]="extractedState.getNextPieceType()"></app-next-box>
            </app-tetris-panel-item>
            <app-tetris-panel-item>
                <app-rating-subsection *ngIf="getMoveRating() as rateMoveDeep"
                    [playerEval]="rateMoveDeep.playerNB"
                    [rating]="rateMoveDeep.rating"
                    >
                </app-rating-subsection>
            </app-tetris-panel-item>

        </app-tetris-panel>
    </app-section>
    <div class="col-misc">
        <video #videoElement autoplay></video>
        <div class="col-misc-bottom">
            <app-section class="time-notes">
                <p class="padded">Time recorded</p>
                <app-subsection>
                    <h1>00:23:14</h1>
                </app-subsection>
                <p class="padded">Notes</p>
                <app-subsection class="notes-section">
                    <p class="notes">
                        Trying to get colors with the help of tetrisfish stacking!
                    </p>
                </app-subsection>
            </app-section>
            <div class="buttons">
                <app-button-big label="Edit Calibration" icon="calibrate_button.svg" (click)="onSwitchMode.emit()"/>
                <app-button-big label="Analyze" icon="analysis_button.svg" />
                <a routerLink="/debug" routerLinkActive="active">
                    <app-button-big label="Debug" icon="debug_button.svg" />
                </a>
            </div>
        </div>
    </div>

</div>